#!/usr/bin/env node
'use strict';

/* eslint no-unused-vars: off */

/**
 * Module dependencies.
 */

var cli = require('../lib/cli/cli');
var Mocha = require('../');
var mocha = new Mocha();

var program = cli.makeCommand();

// actions

cli.addActions(program);

// parse args (since we override parse it will handle --opts correctly)

program.parse(process.argv);

// set options in mocha
cli.setMochaOptions(
  mocha,
  program.opts()
);

// requires

program.require.forEach(function (mod) {
  // if this needs to be called in the correct context add another function
  // cli.require(module, requires) then module.require.call(module, requires)...
  require(mod);
});

var files = cli.resolveFiles(program.args, program.opts());

cli.run(mocha, program, files);
