name: PR Checklist Reminder

# Adds a helpful checklist to PRs that don't have one
# Learn more: https://github.com/actions/github-script

on:
  pull_request_target:
    types: [opened]

permissions:
  pull-requests: write

jobs:
  add-checklist:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            const pr = context.payload.pull_request;
            const prBody = pr.body || '';
            
            // Check if PR already has checklist items
            const hasChecklist = prBody.includes('- [') || prBody.includes('* [');
            
            if (!hasChecklist) {
              const checklist = `
              
              ---
              
              ## PR Checklist
              
              Please ensure your PR meets the following criteria:
              
              - [ ] I have read the [Contributing Guidelines](https://github.com/mochajs/mocha/blob/main/.github/CONTRIBUTING.md)
              - [ ] Tests added/updated for changes (if applicable)
              - [ ] Documentation updated (if applicable)
              - [ ] All tests pass locally (\`npm test\`)
              - [ ] No new linting errors (\`npm run lint\`)
              - [ ] Commit messages are descriptive
              
              _This checklist was automatically added. Feel free to remove it if not applicable._`;
              
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: pr.number,
                body: checklist
              });
              
              console.log('Added checklist comment to PR');
            } else {
              console.log('PR already has a checklist');
            }
